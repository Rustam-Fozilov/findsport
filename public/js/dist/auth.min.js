"use strict";function ownKeys(i,e){var t,o=Object.keys(i);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(i),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})),o.push.apply(o,t)),o}function _objectSpread(i){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(i,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(t,e))})}return i}function _defineProperty(e,i,t){return i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}window.application.module("auth",function(i,t,o,r,e,s,n){var a,l,h,u,c,d,m,p,v,f,w,g,b,V,y,_,E,S,I,P,R,C,M,O;function U(e){R.functions.showView(R.constants.VIEW_LOGIN,_objectSpread(_objectSpread({},e),{},{scenario:"phone_login",modelUrl:"/auth/merge/login",oAuthAction:"merge",template:"foundUserByPhoneForm",backURL:"phoneVerify",showSuccessPasswordRecovery:!1}))}i.constants={VIEW_REGISTER:"register",VIEW_LOGIN:"login",VIEW_MISSING_CONTACTS:"missingData",VIEW_PHONE_VERIFY:"phoneVerify",VIEW_CODE_VERIFY:"phoneVerifyCode",VIEW_PASSWORD_RECOVERY:"passwordRecovery"},i.behaviors=i.views=i.functions=i.validators={},l=o,h=s,(a=i).views.BaseView=r.ItemView.extend({template:null,behaviors:{},requiredBehaviors:{},ui:{},Model:null,modelEvents:{error:"onError"},initialize:function(e){this.options=e,this.selectors=e.selectors||this.selectors,this.model=this.Model?new this.Model:null,e.template&&(this.template=e.template),e.modelUrl&&(this.model.url=e.modelUrl),e.email&&this.model.set("email",e.email),e.phone&&this.model.set("phone",e.phone),e.standbySecondsToWait&&this.model.set("seconds",e.standbySecondsToWait),e.scenario&&this.model.set("scenario",e.scenario),l.Validation.bind(this),this._attachBehaviors()},serializeData:function(){return{options:this.options,model:this.model}},onError:function(){window.location.reload()},onSuccess:function(e){e&&e.returnUrl&&(this.options.redirectUrl=e.returnUrl),e&&e.nextView?a.functions.showView(e.nextView,e.options||{}):window.location.replace(decodeURIComponent(this.options.redirectUrl||window.location.href))},_attachBehaviors:function(){var e={};this.options.enableInlineValidation&&h.extend(e,{InlineValidation:{behaviorClass:a.behaviors.InlineValidation}}),this.options.tooltipError?h.extend(e,{Submit:{behaviorClass:a.behaviors.TooltipValidationError}}):h.extend(e,{Submit:{behaviorClass:a.behaviors.SummaryValidationError}}),h.extend(e,{SubmitOnEnterBehavior:{behaviorClass:a.behaviors.SubmitOnEnterBehavior},PlaceholderBehavior:{behaviorClass:a.behaviors.PlaceholderBehavior}}),this._behaviors=Marionette.Behaviors(this,h.extend(e,this.requiredBehaviors))}}),c=t,d=e,m=s,(u=i).functions.openSocialNetworkWindow=function(e){u.functions.stopEvent(e);var i=d(e.currentTarget),t=(window.screen.width-800)/2,o=(window.screen.height-480)/2,r=i.data("redirect-url")||encodeURIComponent(window.location.href),e=i.data("social-service"),i=i.data("oauth-action"),o=window.open("/auth/auth/oAuthLogin?service="+e+"&action="+i+"&returnUrl="+r,null,"width=800,height=480,left="+t+",top="+o+",resizable=yes,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no,status=yes");return o.focus(),o},u.functions.stopEvent=function(e){e.preventDefault(),e.stopPropagation()},u.functions.switchView=function(e){u.functions.stopEvent(e),u.functions.showView.call(this,d(e.currentTarget).data("toggle-view"))},u.functions.showView=function(e,i){var t=null,o=_objectSpread(_objectSpread({},u.options[e]),i);switch(e){case u.constants.VIEW_REGISTER:t=new u.views.RegisterView(o);break;case u.constants.VIEW_MISSING_CONTACTS:t=new u.views.MissingUserDataView(o);break;case u.constants.VIEW_PHONE_VERIFY:t=new u.views.PhoneVerifyStep1View(o);break;case u.constants.VIEW_CODE_VERIFY:t=new u.views.PhoneVerifyStep2View(o);break;case u.constants.VIEW_LOGIN:var r=u.views.LoginView;this.options&&this.options.loginModel&&this.options.loginTemplate&&(r.Model=this.options.loginModel,r.template=this.options.loginTemplate),t=new r(o);break;case u.constants.VIEW_PASSWORD_RECOVERY:t=new u.views.PasswordRecoveryView(m.extend(o,{loginModel:this.model,loginTemplate:this.template,email:this.model.get("email")}))}c.AuthRegion.show(t)},i.behaviors.InlineValidation=r.Behavior.extend({lastInputWithError:null,ui:{inputs:"input:not([type=submit])"},events:{"focusout @ui.inputs":"onFocusOut","focusin @ui.inputs":"onFocusIn"},onFocusIn:function(e){var i=this.view.ui[e.currentTarget.id];this._hasFormError(i)?this._showFormError(i,this.view.model.preValidate(e.currentTarget.id,i.val())):this.lastInputWithError&&this._showFormError(this.lastInputWithError.$input,this.lastInputWithError.error)},onFocusOut:function(e){var i=this,t=this.view.ui[e.currentTarget.id],o=this.view.model.preValidate(e.currentTarget.id,t.val());o?(this._addFormError(t,o),setTimeout(function(){"INPUT"!=document.activeElement.tagName&&i._showFormError(t,o)},0)):this._removeFormError(t)},_addFormError:function(e,i){this.lastInputWithError={$input:e,error:i},e.closest("."+this.view.selectors.inputGroup).addClass(this.view.selectors.error)},_hasFormError:function(e){return e.closest("."+this.view.selectors.inputGroup).hasClass(this.view.selectors.error)},_showFormError:function(e,i){this.ui.inputs.tooltip("destroy"),e.tooltip({trigger:"manual",placement:"top",title:i}),e.tooltip("show")},_removeFormError:function(e){e.closest("."+this.view.selectors.inputGroup).removeClass(this.view.selectors.error),e.tooltip("destroy"),this.lastInputWithError=null}}),(p=i).behaviors.SMSCodeWaitLinkBehavior=r.Behavior.extend({ui:{waitElement:".-js-phone-verify-wait-container",waitElementDefault:".-js-phone-verify-wait-default",waitElementAlt:".-js-phone-verify-wait-alt",sendNewCodeLink:".-js-phone-verify-send"},WAIT_TIME_STEP:1e3,events:{"click @ui.sendNewCodeLink":"onWaitLinkClick"},_interval:null,onWaitLinkClick:function(e){e.preventDefault();var i=this._interval,e=this.view.options.standbySecondsToWait;e&&(this.sendCode(),i&&this.clearWaitInterval(i),this.updateInterval(e))},sendCode:function(){var e=new p.PhoneVerifyForm;e.set("phone",this.view.model.get("phone")),e.save()},updateInterval:function(e){var i=this,t=this._interval,o=this.ui.waitElement,r=o.find(this.ui.waitElementAlt);this.refreshStandbyResendText(r,e),this.toggleWaitElement(o,!0),t=setInterval(function(){e--,i.setModelSeconds(e),0<e?i.refreshStandbyResendText(r,e):(i.clearWaitInterval(t),i.toggleWaitElement(o,!1))},this.WAIT_TIME_STEP),this._interval=t},toggleWaitElement:function(e,i){e.find(this.ui.waitElementDefault).toggle(!i),e.find(this.ui.waitElementAlt).toggle(i)},refreshStandbyResendText:function(e,i){var t=this.view.options;this.setModelSeconds(i),e.html(t.standbyResendText.replace(t.standbyTimePattern,i))},clearWaitInterval:function(e){clearInterval(e),this.refreshModelSeconds(),this._interval=null},setModelSeconds:function(e){this.view.model.set("seconds",e,{silent:!0})},refreshModelSeconds:function(){this.setModelSeconds(this.view.options.standbySecondsToWait)},onRender:function(){var e=this.view.model.get("seconds");this._interval&&this.updateInterval(e)}}),v=e,i.behaviors.PhoneVerificationBehavior=r.Behavior.extend({ui:{phoneInput:".-js-phone-input",phoneCodeInput:".-js-phone-code-input",phoneVerificationSendView:".-js-phone-verify-default",phoneVerificationCheckView:".-js-phone-verify-code"},triggers:{"click @ui.phoneVerificationSendButton":"before:submit:phone"},onSubmitPhoneInit:function(){this.togglePhoneVerificationView(!1),this.view.toggleReadyForSubmit(!1)},onSubmitPhoneStart:function(){this.resetInputCode()},onSubmitPhoneSuccess:function(){this.togglePhoneVerificationView(!0),this.view.toggleReadyForSubmit(!0),this.ui.phoneCodeInput.focus()},onBeforeSubmitPhone:function(){(this.view.isReadyForSubmit()||this.view.isModelValid())&&this.sendCode()},sendCode:function(){var t=this.view,e=this.getInputPhone();e&&(t.triggerMethod("submit:phone:start"),e={PhoneVerifyForm:{phone:e}},v.post("/auth/verify/phone",e).done(function(e){t.triggerMethod("submit:phone:success",e)}).fail(function(e){var i;try{i=v.parseJSON(e.responseText)}catch(e){i={error:-1,message:"Ошибка сервера. Попробуйте перезагрузить страницу."}}t.triggerMethod("submit:phone:error",i)}))},getInputPhone:function(){return this.cleanPhone(this.ui.phoneInput.val())},cleanPhone:function(e){e=e.toString().replace(/\D/g,"").replace(/^8/,"7");return/^79\d{9}$/.test(e)||/^9\d{9}$/.test(e)?e:""},resetInputCode:function(){this.ui.phoneCodeInput.val("")},togglePhoneVerificationView:function(e){this.ui.phoneVerificationSendView.toggle(!e),this.ui.phoneVerificationCheckView.toggle(e)}}),f=e,w=s,i.behaviors.PlaceholderBehavior=r.Behavior.extend({ui:{fields:"input:text, input:password"},events:{"blur @ui.fields":"onBlur","focus @ui.fields":"onFocus"},onBlur:function(e){var i=f(e.currentTarget),t=i.attr("placeholder"),e=i.attr("id");e in this.view.model.labels&&!0===f.fn.placeholder.input&&!w.isUndefined(t)&&!1!==t&&i.attr("placeholder",this.view.model.labels[e])},onFocus:function(e){var i=f(e.currentTarget),t=i.attr("placeholder"),e=i.attr("id");e in this.view.model.labelsAcc&&!0===f.fn.placeholder.input&&!w.isUndefined(t)&&!1!==t&&i.attr("placeholder","Введите "+this.view.model.labelsAcc[e])},onRender:function(){this.ui.fields.placeholder()}}),g=s,i.behaviors.Submit=r.Behavior.extend({events:{"click @ui.submit":"onSubmit","focusout @ui.submit":"onFocusOut"},modelEvents:{validated:"onValidated",request:"onRequest",sync:"onSynced"},onFocusOut:function(){this.ui.submit.tooltip("destroy")},onRequest:function(){this.ui.submit.attr("disabled","disabled").addClass("button_disabled")},onSubmit:function(e){e.preventDefault(),e.stopPropagation();var i=this.view.model,t=this.view.ui,e=g.keys(i.attributes),o={};g.each(e,function(e){if(void 0!==t[e])switch(t[e].attr("type")){case"text":case"password":o[e]=t[e].val();break;case"checkbox":o[e]=t[e].prop("checked")}}),i.set(o),i.isValid(!0)&&((e={})[i.name]=i.attributes,i.save(i.attributes,{attrs:e,validate:!1}))},onSynced:function(e,i){if(i&&i.errors){if("_server"in i.errors&&("email"in i.errors||"phone"in i.errors))try{var t;if("phone"in i.errors)return t=JSON.parse(i.errors.phone),void this.view.onUniquePhoneError(t);if("email"in i.errors)return t=JSON.parse(i.errors.email),void this.view.onUniqueEmailError(t)}catch(e){}this.view.render(),this._showSubmitError()}else this.view.triggerMethod("success",i)},onValidated:function(e,i,t){e?i.unset("errors"):(i.set("errors",t),this.view.render(),this._showSubmitError())},_showSubmitError:function(){}}),b=e,i.behaviors.SubmitOnEnterBehavior=r.Behavior.extend({ui:{fields:"input:not([type=submit])"},events:{"keypress @ui.fields":"onFieldKeyPress"},onFieldKeyPress:function(e){13==e.which&&(e.preventDefault(),e.stopPropagation(),b(e.currentTarget).focusout(),this.view.ui.submit.focus().click())}}),V=s,i.behaviors.SummaryValidationError=i.behaviors.Submit.extend({ui:{summary:".-js-error-summary"},_showSubmitError:function(){var i=this.view,t=i.model,o=t.get("errors"),e=t.attributes,r="",s=[],n=[],e=V.filter(V.map(e,function(e,i){if(!e&&"rememberMe"!==i)return i}));e.some(function(e){return V.has(o,e)})?(V.each(e,function(e){V.has(o,e)&&(s.push(t.labelsAcc[e]),n.push(e))}),r="Пожалуйста, введите "+s.join(", ").toLowerCase()):V.has(o,"_server")?V.has(o,"email")?(r=o.email,n.push("email")):V.has(o,"phone")?(r=o.phone,n.push("phone")):V.has(o,"first_name")?(r=o.first_name,n.push("first_name")):V.has(o,"last_name")?(r=o.last_name,n.push("last_name")):V.has(o,"code")?(r=o.code,n.push("code")):(r=o.auth,n=["email","password"]):V.has(o,"email")?(r=o.email,n.push("email")):V.has(o,"phone")?(r=o.phone,n.push("phone")):V.has(o,"password")?(r=o.password,n.push("password")):V.has(o,"code")&&(r=o.code,n.push("code")),V.each(n,function(e){i.$el.find("#"+e).addClass(i.selectors.error).closest("."+i.selectors.inputGroup).addClass(i.selectors.error)}),this.ui.summary.removeClass(i.selectors.summaryHidden).html(r)}}),y=s,i.behaviors.TooltipValidationError=i.behaviors.Submit.extend({_showSubmitError:function(){var e=this.view,i=e.ui,t=e.model,e=Object.keys(t.get("errors")),o=[];y.each(e,function(e){y.isUndefined(t.labels[e])||o.push(t.labels[e])}),i.submit.tooltip({trigger:"focus",placement:"left",title:1===o.length?y.first(y.values(y.omit(t.get("errors"),"_server"))):"Заполните поля корректно: "+o.join(", ").toLowerCase()}),i.submit.focus()}}),_=o,E=s,(e=i).validators.phone=[{required:!0,msg:"Не заполнен телефон"},{maxLength:30,msg:"Телефон должен состоять не более чем из 30 символов"},{fn:function(e){e=e.toString().replace(/\D/g,"").replace(/^8/,"7");return 11<e.length||e.length<10?"Номер мобильного телефона должен состоять из 11 цифр.":11===e.length&&!1===/^79\d{9}$/.test(e)||10===e.length&&!1===/^9\d{9}$/.test(e)?"Укажите номер мобильного телефона.":void 0}},{fn:function(e,i){var t=_.Validation.validators;if(E.isUndefined(t.required(e,i))&&this.get("errors")&&this.get("errors")._server&&this.get("errors")._server.verifyPhone&&this.get("errors")._server.verifyPhone[i]==e.replace(/[^0-9]/g,""))return this.get("errors").phone?this.get("errors").phone:"Номер телефона заполнен неверно"}}],e.validators.email=[{required:function(e,i,t){return"phone_login"!==t.scenario},msg:"Не заполнен адрес эл. почты."},{maxLength:127,msg:"Адрес электронной почты должен состоять не более чем из 127 символов"},{pattern:"email",msg:"Указана некорректная электронная почта"},{fn:function(e,i){var t=_.Validation.validators;try{if(E.isUndefined(t.required(e,i))&&E.isUndefined(t.pattern(e,i,"email"))&&this.get("errors")._server.exist[i]===e)return this.get("errors").email}catch(e){}}}],i.LoginModel=o.Model.extend({name:"User",defaults:{email:"",phone:"",password:"",rememberMe:!0},labels:{auth:"Эл. почта и пароль",email:"Электронная почта",phone:"Телефон",password:"Пароль",rememberMe:"Запомнить меня"},labelsAcc:{email:"электронную почту",password:"пароль"},validation:{email:i.validators.email,password:[{required:!0,msg:"Не заполнен пароль"}]},url:"/auth/auth/login"}),i.views.LoginView=i.views.BaseView.extend({template:"loginForm",Model:i.LoginModel,ui:{email:"#email",phone:"#phone",password:"#password",rememberMe:"#rememberMe",submit:"#submit"},events:{"click a[data-toggle-view]":i.functions.switchView,"click a[data-social-service]":i.functions.openSocialNetworkWindow,"change @ui.rememberMe":"onChangeRemember"},selectors:{error:"has-error",inputGroup:"form-group",summaryHidden:"hidden"},onChangeRemember:function(){var e=this.ui.rememberMe.prop("checked");this.model.set("rememberMe",e),this.$(".-js-icon-positive").toggle(e)},onRender:function(){var e,i;this.getOption("showSuccessPasswordRecovery")&&(this.options.showSuccessPasswordRecovery=!1,(i=(e=this).$el.find(".-js-success-password-recovery")).removeClass(this.selectors.summaryHidden),setTimeout(function(){i.addClass(e.selectors.summaryHidden)},5e3))}}),i.MissingUserDataForm=o.Model.extend({name:"MissingUserDataForm",defaults:{email:"",phone:"",subscribe:!0},labels:{email:"Электронная почта",phone:"Номер телефона",subscribe:"Подписка на рассылки"},labelsAcc:{phone:"телефон",email:"электронную почту"},validation:{email:i.validators.email,phone:i.validators.phone},url:"/auth/verify/contacts"}),(S=i).views.MissingUserDataView=S.views.BaseView.extend({template:"missingUserDataForm",Model:S.MissingUserDataForm,ui:{email:"#email",phone:"#phone",subscribe:"#subscribe",submit:"#submit"},events:{"change @ui.subscribe":"onChangeSubscribe"},selectors:{error:"has-error",inputGroup:"form-group",summaryHidden:"hidden"},onChangeSubscribe:function(){var e=this.ui.subscribe.prop("checked");this.model.set("subscribe",e),this.$(".-js-icon-positive").toggle(e)},onUniqueEmailError:function(e){S.functions.showView(S.constants.VIEW_LOGIN,_objectSpread(_objectSpread({},e),{},{template:"foundUserByEmailForm",backURL:"missingData",phone:null,scenario:null,modelUrl:"/auth/merge/login",oAuthAction:"merge"}))},onUniquePhoneError:function(e){S.functions.showView(S.constants.VIEW_LOGIN,_objectSpread(_objectSpread({},e),{},{template:"foundUserByPhoneForm",backURL:"missingData",scenario:"phone_login",modelUrl:"/auth/merge/login",oAuthAction:"merge"}))}}),I=s,i.PasswordRecoveryModel=o.Model.extend({name:"PasswordRecoverForm",defaults:{email:""},labels:{email:"Электронная почта"},labelsAcc:{email:"электронную почту"},validation:{email:i.validators.email,_server:{fn:function(e){var o=this,r={};if(I.each(e,function(e,t){I.each(e,function(e,i){o.get(i)==e&&(r[t]=r[t]||{},r[t][i]=e)})}),!I.isEmpty(r))return r}}},url:"/auth/auth/passwordRecovery"}),(P=i).views.PasswordRecoveryView=P.views.BaseView.extend({template:"passwordRecovery",Model:P.PasswordRecoveryModel,ui:{email:"#email",submit:"#submit"},selectors:{error:"has-error",inputGroup:"form-group",summaryHidden:"hidden"},events:{"click a[data-toggle-view]":P.functions.switchView},onSuccess:function(){P.functions.showView(P.constants.VIEW_LOGIN,{email:this.model.get("email"),modelUrl:this.options.loginModel.url,scenario:null,showSuccessPasswordRecovery:!0})}}),i.PhoneCodeVerifyForm=o.Model.extend({name:"PhoneCodeVerifyForm",defaults:{phone:"",code:"",seconds:null},labels:{phone:"Номер телефона",code:"Код из СМС"},labelsAcc:{phone:"телефон",code:"код из смс"},validation:{phone:i.validators.phone,code:[{required:!0,msg:"Не заполнен код подтверждения. Мы высылали его по СМС."},{pattern:/^\d{5}$/,msg:"Код должен содержать 5 цифр."}]},url:"/auth/verify/code"}),i.PhoneVerifyForm=o.Model.extend({name:"PhoneVerifyForm",url:"/auth/verify/phone",defaults:{phone:""},labels:{phone:"Номер телефона"},labelsAcc:{phone:"телефон"},validation:{phone:i.validators.phone}}),(R=i).views.PhoneVerifyStep1View=R.views.BaseView.extend({template:"phoneVerifyStep1Form",ui:{phone:"#phone",submit:"#submit"},selectors:{error:"has-error",inputGroup:"form-group",summaryHidden:"hidden"},Model:R.PhoneVerifyForm,onUniquePhoneError:U}),R.views.PhoneVerifyStep2View=R.views.BaseView.extend({template:"phoneVerifyStep2Form",CODE_LENGTH:5,requiredBehaviors:{phoneVerificationBehavior:{behaviorClass:R.behaviors.PhoneVerificationBehavior},smsCodeWaitLinkBehavior:{behaviorClass:R.behaviors.SMSCodeWaitLinkBehavior}},ui:{phone:"#phone",code:"#code",submit:"#submit"},selectors:{error:"has-error",inputGroup:"form-group",summaryHidden:"hidden"},events:{"click a[data-toggle-view]":R.functions.switchView},Model:R.PhoneCodeVerifyForm,onUniquePhoneError:U}),C=o,M=s,i.RegisterModel=C.Model.extend({name:"User",defaults:{first_name:"",last_name:"",email:"",phone:"",password:"",subscribe:!0},labels:{first_name:"Имя",last_name:"Фамилия",email:"Электронная почта",phone:"Телефон",password:"Пароль",subscribe:"Подписка на рассылки"},labelsAcc:{first_name:"имя",last_name:"фамилию",phone:"телефон",email:"электронную почту",password:"пароль"},validation:{first_name:[{required:!0,msg:"Не заполнено имя"},{maxLength:100,msg:"Имя должно состоять не более чем из 100 символов"},{fn:function(e,i){var t=C.Validation.validators;if(M.isUndefined(t.required(e,i))&&M.isUndefined(t.maxLength(e,i))&&this.get("errors")&&this.get("errors")._server&&this.get("errors")._server.verifyName&&this.get("errors")._server.verifyName[i]==e)return"Имя не может содержать спец. символы"}}],last_name:[{required:!0,msg:"Не заполнена фамилия"},{maxLength:100,msg:"Фамилия должна состоять не более чем из 100 символов"},{fn:function(e,i){var t=C.Validation.validators;if(M.isUndefined(t.required(e,i))&&M.isUndefined(t.maxLength(e,i))&&this.get("errors")&&this.get("errors")._server&&this.get("errors")._server.verifyName&&this.get("errors")._server.verifyName[i]==e)return"Фамилия не может содержать спец. символы"}}],email:i.validators.email,phone:i.validators.phone,password:[{required:!0,msg:"Не заполнен пароль"},{minLength:6,msg:"Недостаточно надёжный пароль. Пароль должен состоять не менее чем из 6 символов"}],_server:{fn:function(e){var o=this,r={};if(M.each(e,function(e,t){M.each(e,function(e,i){("phone"==i&&o.get(i).replace(/[^0-9]/g,"")==e||"phone"!=i&&o.get(i)==e)&&(r[t]=r[t]||{},r[t][i]=e)})}),!M.isEmpty(r))return r}}},url:"/auth/auth/register"}),(O=i).views.RegisterView=O.views.BaseView.extend({template:"registerForm",Model:O.RegisterModel,ui:{first_name:"#first_name",last_name:"#last_name",email:"#email",phone:"#phone",password:"#password",subscribe:"#subscribe",submit:"#submit"},events:{"click a[data-toggle-view]":O.functions.switchView,"click a[data-social-service]":O.functions.openSocialNetworkWindow,"change @ui.subscribe":"onChangeSubscribe"},selectors:{error:"has-error",inputGroup:"form-group",summaryHidden:"hidden"},onChangeSubscribe:function(){var e=this.ui.subscribe.prop("checked");this.model.set("subscribe",e),this.$(".-js-icon-positive").toggle(e)},onUniqueEmailError:function(e){O.functions.showView(O.constants.VIEW_LOGIN,_objectSpread(_objectSpread({},e),{},{template:"foundUserByEmailForm",backURL:"register",phone:null,scenario:null,oAuthAction:"login"}))},onUniquePhoneError:function(e){O.functions.showView(O.constants.VIEW_LOGIN,_objectSpread(_objectSpread({},e),{},{template:"foundUserByPhoneForm",backURL:"register",scenario:"phone_login",oAuthAction:"login"}))}}),r.Behaviors.behaviorsLookup=function(){return i.Behaviors},i.on("start",function(e){switch(i.options=e,s.extend(o.Validation.patterns,e.patterns||{}),t.addRegions({AuthRegion:r.Region.extend({el:"#auth-region",attachHtml:function(e){this.$el.empty().append(e.el),this.$el.hide().fadeIn("fast")}})}),e.view){case i.constants.VIEW_REGISTER:t.AuthRegion.show(new i.views.RegisterView(e.register));break;case i.constants.VIEW_PASSWORD_RECOVERY:t.AuthRegion.show(new i.views.PasswordRecoveryView(e.passwordRecovery));break;case i.constants.VIEW_MISSING_CONTACTS:t.AuthRegion.show(new i.views.MissingUserDataView(e.missingData));break;case i.constants.VIEW_PHONE_VERIFY:t.AuthRegion.show(new i.views.PhoneVerifyStep1View(e.phoneVerify));break;default:t.AuthRegion.show(new i.views.LoginView(e.login))}})},Handlebars);